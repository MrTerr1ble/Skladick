{% extends "base.html" %}

{% block title %}–ó–∞—è–≤–∫–∞ {{ purchase_request.number }}{% endblock %}

{% block topbar %}
<div class="topbar">
  <div class="tabs">
    <div class="tab active">–ó–ê–Ø–í–ö–ê ‚Ññ {{ purchase_request.number }}</div>
  </div>
  <div class="profile">
    <a class="btn ghost" href="{% url 'procurement:purchase_request_list' %}">–ù–∞–∑–∞–¥</a>
    <a class="btn" href="{% url 'procurement:purchase_request_update' purchase_request.pk %}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="container">
  <div class="card">
    <div class="field">
      <span class="label">–°—Ç–∞—Ç—É—Å</span>
      <div class="value">{{ purchase_request.get_state_display }}</div>
    </div>
    <div class="field">
      <span class="label">–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞</span>
      <div class="value">{{ purchase_request.item }}</div>
    </div>
    <div class="field">
      <span class="label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span>
      <div class="value">{{ purchase_request.qty }} {{ purchase_request.uom.code }}</div>
    </div>
    <div class="field">
      <span class="label">–°–∫–ª–∞–¥</span>
      <div class="value">{{ purchase_request.warehouse }}</div>
    </div>
    <div class="field">
      <span class="label">–ü–æ—Å—Ç–∞–≤—â–∏–∫</span>
      <div class="value">{{ purchase_request.supplier|default:"‚Äî" }}</div>
    </div>
    <div class="field">
      <span class="label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</span>
      <div class="value">{{ purchase_request.comment|default:"‚Äî" }}</div>
    </div>
    <div class="field">
      <span class="label">–§–∞–π–ª</span>
      <div class="value">
        {% if purchase_request.attachment %}
          <a href="{{ purchase_request.attachment.url }}" target="_blank">–°–∫–∞—á–∞—Ç—å</a>
        {% else %} ‚Äî {% endif %}
      </div>
    </div>
  </div>

  <div class="toolbar spaced">
    {% if purchase_request.state == 'DRAFT' %}
      <form method="post" action="{% url 'procurement:purchase_request_status_change' purchase_request.pk 'submit' %}">
        {% csrf_token %}
        <button class="btn primary" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</button>
      </form>
    {% elif purchase_request.state == 'SUBMITTED' %}
      <form method="post" action="{% url 'procurement:purchase_request_status_change' purchase_request.pk 'approve' %}" class="inline-form">
        {% csrf_token %}
        <button class="btn primary" type="submit">–£—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </form>
      <form method="post" action="{% url 'procurement:purchase_request_status_change' purchase_request.pk 'reject' %}" class="inline-form">
        {% csrf_token %}
        <button class="btn danger" type="submit">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
      </form>
    {% elif purchase_request.state == 'APPROVED' %}
      <div class="text-success">‚úÖ –ó–∞—è–≤–∫–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞</div>
    {% elif purchase_request.state == 'ORDERED' %}
      <div class="text-success">üì¶ –ó–∞–∫—É–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞, –æ–∂–∏–¥–∞–µ–º –ø–æ—Å—Ç–∞–≤–∫—É</div>
    {% elif purchase_request.state == 'CLOSED' %}
      <div class="muted">‚ÑπÔ∏è –ó–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞</div>
    {% elif purchase_request.state == 'REJECTED' %}
      <div class="text-danger">‚ùå –ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞</div>
    {% endif %}
  </div>
</div>
{% endblock %}
